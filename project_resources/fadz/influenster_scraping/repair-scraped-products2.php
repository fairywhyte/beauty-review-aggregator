<?php

//define the file you wish to work with
$source_file = 'influenster.csv';
$target_file = 'influenster-corrected3.csv';

//open the file to read it
$fh = fopen($source_file, 'r');

//open the file to write into it
$fh2 = fopen($target_file, 'w');
$all_my_unique_column_values = [];

$remove = [

    1 => "-7",
    2 => "20%",
    3 => "- 1 fl oz",
    4 => "- 2 oz",
    5 => "- 3 Combo Pack - 1 fl oz / 30 ml each.",
    6 => "- 35ml-1.2oz",
    7 => "- 40ml/1.35oz by Helena Rubinstein",
    8 => "- 50ml-1.7oz",
    9 => "- Pack of 2",
    10 => "-15ml/0.5oz (women)",
    11 => "(10ml)",
    12 => "(1oz)",
    13 => "(2 oz)",
    14 => "(30ml)",
    15 => "(Salon Product) 100ml/3.3oz",
    16 => "(Salon Size) 60ml/2oz",
    17 => "+. Prevent / Hydrate - 2 Combo Pack - 1 fl oz / 30 ml each.",
    18 => "0.5 Ounce",
    19 => "0.5 oz Gel",
    20 => "1 oz",
    21 => "1.69oz",
    22 => "120ml 120ml",
    23 => "250ml",
    24 => "2oz",
    25 => "2X 1 oz",
    26 => "300ml 300ml",
    27 => "30gr 1oz",
    28 => "30ml",
    29 => "30mL",
    30 => "30ml 30ml",
    31 => "30ml/1oz",
    32 => "35ml/1.1oz",
    33 => "40ml",
    34 => "40ml 40ml",
    35 => "50ml",
    36 => "50ml/1.6oz",
    37 => "50ml/1.7oz",
    38 => "60ml, Skin serum, NEW",
    39 => "Size 1.6 oz 50ml (Huge, BIGGER Size)",
    40 => "- (0.34 oz / 10 ml)",
    41 => "- 0.25 oz Travel Size",
    42 => "- 0.5 oz",
    43 => "- 0.5 oz.",
    44 => "- 1 fl oz",
    45 => "- 1 fl oz + travel trial size Vivierskin® C E Peptides",
    46 => "- 1 fl. oz.",
    47 => "- 1 oz",
    48 => "- 1 oz by Life Extension",
    49 => "- 1 oz Serum",
    50 => "- 1 Oz Serum",
    51 => "- 1 oz.",
    52 => "- 1.0 fl oz + 2 ® Travel Packets",
    53 => "- 1.02 oz.",
    54 => "- 1.1 Ounce",
    55 => "- 1.7 fl oz",
    56 => "- 1.7 oz",
    57 => "- 1.7 oz.",
    58 => "- 120ml/4oz",
    59 => "- 15ml-0.5oz",
    60 => "- 1oz.",
    61 => "- 2.5 oz.",
    62 => "- 30 Ml",
    63 => "- 30 ml",
    64 => "- 30ml 1oz",
    65 => "- 30ml-1.01oz",
    66 => "- 30ml-1oz",
    67 => "- 30ml/1oz",
    68 => "- 40 ml",
    69 => "- Pack of 2",
    70 => "--/1.05OZ - Night Care",
    71 => "--/1OZ",
    72 => "--30Ml/1Oz By",
    73 => "-1 oz",
    74 => "-1.1 oz Serum",
    75 => "-30 ml",
    76 => ", .34 oz",
    77 => ", .5 oz",
    78 => ", .5oz 1oz 2oz , Anti-Aging Peptide (15ml)",
    79 => ", .6 oz",
    80 => ", .67 oz",
    81 => ", 0.13oz",
    82 => ", 0.5 Fl Oz",
    83 => ", 0.5 fl. oz.",
    84 => ", 0.5 Fluid Ounce",
    85 => ", 0.5 oz",
    86 => ", 0.5-Ounce",
    87 => ", 0.5-Oz",
    88 => ", 0.85 oz (Pack of 1)",
    89 => ", 0.9 oz",
    90 => ", 1 fl oz",
    91 => ", 1 fl. oz.",
    92 => ", 1 Fluid Ounce",
    93 => ", 1 Ounce",
    94 => ", 1 Oz",
    95 => ", 1 oz",
    96 => ", 1 Oz (28 G)",
    97 => ", 1 oz (30 ml)",
    98 => ", 1 oz, Mellisa B Naturally",
    99 => ", 1-Fluid Ounce",
    100 => ", 1-Ounce Bottle",
    101 => ", 1.0 fl. oz.",
    102 => ", 1.0 oz.",
    103 => ", 1.0 oz./ 30 mL",
    104 => ", 1.02 Fluid Ounce",
    105 => ", 1.1 oz",
    106 => ", 1.25 fl. Oz.",
    107 => ", 1.3 fl oz",
    108 => ", 1.3 oz",
    109 => ", 1.3 oz.",
    110 => ", 1.35 fl oz",
    111 => ", 1.69 fl oz",
    112 => ", 1.69 fl oz (50 ml)",
    113 => ", 1.7 fl oz",
    114 => ", 1.7 Ounce",
    115 => ", 1.7 Oz",
    116 => ", 1.7 oz",
    117 => ", 1.75 Oz",
    118 => ", 1oz",
    119 => ", 2 fl oz",
    120 => ", 2 oz",
    121 => ", 2 oz",
    122 => ", 2-Fluid Ounce",
    123 => ", 2.0 oz.",
    124 => ", 2.4 oz.",
    125 => ", 20%, 1 fl oz",
    126 => ", 200mL",
    127 => ", 20ml",
    128 => ", 25 mL",
    129 => ", 25ml",
    130 => ", 3.3 oz",
    131 => ", 30 mL",
    132 => ", 30 ml",
    133 => ", 30ml",
    134 => ", 4 oz - Pack of 2",
    135 => ", 50 mL",
    136 => ", 6 oz",
    137 => ", DLX Sample, .35 oz.",
    138 => ", Size 1.7 oz",
    139 => ", Unscented 2 fl oz (58 ml)",
    140 => ",1 fl oz/30 ml",
    141 => ",30 ml,(1 fl OZ)",
    142 => "!",
    143 => "?(30ml)",
    144 => ".01 oz",
    145 => ".01 oz/ 30 mL",
    146 => ".17 Oz",
    147 => ".17oz/5ml Sample/Travel Size Pumps, Totals .34oz/10ml",
    148 => ".33 oz Roll-on",
    149 => ".5 fl.oz.",
    150 => ".5 oz",
    151 => ".5 oz.",
    152 => ".5oz by Suki Skincare",
    153 => ".68 oz.",
    154 => ".7 oz",
    155 => ".7 oz/ 50 mL",
    156 => "(.075% Retinol), 1 fl oz",
    157 => "(.24oz/7ml)",
    158 => "(.5oz)",
    159 => "(1 fl oz / 30 ml)",
    160 => "(1 oz.)",
    161 => "(1 oz)",
    162 => "(1.0 fl oz / 30 ml)",
    163 => "(1.0 Oz) - Medical Grade",
    164 => "(10ml)",
    165 => "(13mL)",
    166 => "(15ml)",
    167 => "(2 Bottles)",
    168 => "(2 Pack)",
    169 => "(2oz)",
    170 => "(3 Bottles)",
    171 => "(30ml)",
    172 => "(3x10ml)",
    173 => "(40g)",
    174 => "(60g)",
    175 => "(For All Skin Types) 30ml/1oz",
    176 => "(New Packing) 30ml/1oz",
    177 => "(Phaze 42)",
    178 => "(Salon Product) 100ml/3.3oz",
    179 => "(Salon Size) 100ml/3.4oz",
    180 => "(Salon Size) 50ml/1.69oz",
    181 => "(Salon Size) 90ml/3oz",
    182 => "(salon Size) D49l",
    183 => "(Salon Size) D49L 100ml/3.4oz",
    184 => "/ 0.8 oz",
    185 => "/ 35ml.",
    186 => "/1 oz. - No Color",
    187 => "/1.7 oz. - No Color",
    188 => "® 10 Oz.",
    189 => "| 1 Oz Airless Bottle",
    190 => "0.17 Fl.oz",
    191 => "0.27 fl.oz./8mL",
    192 => "0.3 oz. Box",
    193 => "0.5 oz",
    194 => "0.5 Oz (No Pump) Un-boxed.",
    195 => "0.5 oz Cream",
    196 => "0.5 oz Liquid",
    197 => "0.5 oz.",
    198 => "0.5 oz/ 15 mL",
    199 => "0.5 oz/15 ml",
    200 => "0.5oz, 15ml",
    201 => "0.68 oz/ 20 mL",
    202 => "03, 1 oz.",
    203 => "0ml",
    204 => "1 fl oz",
    205 => "1 Fl Oz",
    206 => "1 fl oz (29.6 ml) Serum",
    207 => "1 fl oz.",
    208 => "1 fl oz/ 30 ml",
    209 => "1 fl. oz.",
    210 => "1 fl. oz. L'Occitane",
    211 => "1 fl. oz. Tube",
    212 => "1 fl. oz.-Original Dead Sea Minerals",
    213 => "1 fl. oz.(30 mL), 1 bottle",
    214 => "1 Fluid Ounces Serum - Cleansers & Moisturizers",
    215 => "1 Ounce",
    216 => "1 Ounce Bottle",
    217 => "1 oz",
    218 => "1 Oz",
    219 => "1 oz (30 ml)",
    220 => "1 oz (empty bottle for custom-blended serums)",
    221 => "1 oz | Rejuvenating",
    222 => "1 oz Liquid",
    223 => "1 oz Pump",
    224 => "1 oz Pump Bottle",
    225 => "1 oz.",
    226 => "1 oz/ 30 mL",
    227 => "1 oz/30 ml",
    228 => "1 pc",
    229 => "1.0 fl.oz",
    230 => "1.0 fl.oz./30mL",
    231 => "1.0 oz",
    232 => "1.0 oz Not Youthology",
    233 => "1.1 fl oz.",
    234 => "1.25oz",
    235 => "1.35 fl oz",
    236 => "1.35 oz",
    237 => "1.48 fl oz",
    238 => "1.5 oz",
    239 => "1.5ml",
    240 => "1.6 oz",
    241 => "1.69 fl. oz",
    242 => "1.69 oz",
    243 => "1.7 Fl Oz",
    244 => "1.7 fl oz (50 ml)",
    245 => "1.7 Ounce [Ampoule 50ml]",
    246 => "1.7 oz",
    247 => "1.7 oz Liquid",
    248 => "1.7OZ/50 ML",
    249 => "100 100ml 100ml",
    250 => "100ml",
    251 => "100ml 100ml",
    252 => "100ml/3.3oz",
    253 => "100ml/3.62oz",
    254 => "105ml 105ml",
    255 => "10ml",
    256 => "10ml Each Ampoule",
    257 => "10ml x 4",
    258 => "10ml/0.35oz",
    259 => "10ml/0.3oz",
    260 => "10pcs 1 box",
    261 => "10x3.5ml/0.12oz",
    262 => "120ml",
    263 => "120ml 120ml",
    264 => "125ml/4.22oz",
    265 => "130ml",
    266 => "14pcs 2ml x 14pcs",
    267 => "15 ml",
    268 => "15 ml / 0.5 oz.",
    269 => "150g",
    270 => "150ml",
    271 => "150ml 150ml",
    272 => "15g 15g",
    273 => "15ml",
    274 => "15ML",
    275 => "15ml 15ml",
    276 => "15ml Face",
    277 => "15ml/0.5oz",
    278 => "16ml 16ml",
    279 => "180ml + 20ml 2pcs",
    280 => "1ml(30ml). Super Saver Than Normal Size",
    281 => "1oz",
    282 => "1oz / 30ml",
    283 => "1oz 30ml",
    284 => "1oz.",
    285 => "1pc 7ml",
    286 => "2 oz Liquid",
    287 => "2 Oz.",
    288 => "2.24 oz - Pack of 2",
    289 => "2.53 oz",
    290 => "20 AOX 30 ml",
    291 => "200ml",
    292 => "200ml 200ml",
    293 => "200ml by Therapie",
    294 => "20g/0.7oz",
    295 => "20ml",
    296 => "20ml 20ml",
    297 => "20x5ml/0.17oz",
    298 => "250ml",
    299 => "250ml 250ml",
    300 => "250ml/8oz",
    301 => "25ml",
    302 => "25ml 25ml",
    303 => "26ml/0.8oz",
    304 => "28 x 0.03 oz/ 1 ml",
    305 => "2oz",
    306 => "2oz/60ml Bottle",
    307 => "3 Oz",
    308 => "3.4 oz",
    309 => "3.4 oz/ 100 mL",
    310 => "30 mL",
    311 => "30 ml.",
    312 => "30-Ampoules",
    313 => "300ml 300ml",
    314 => "30g",
    315 => "30g 30g",
    316 => "30ml",
    317 => "30Ml",
    318 => "30ml / 1 oz NEW",
    319 => "30ml /1oz",
    320 => "30ml 1.00 oz",
    321 => "30ml 30ml",
    322 => "30ml-1oz",
    323 => "30ml.",
    324 => "30ml/1.01oz",
    325 => "30ml/1.03oz",
    326 => "30ml/1.05oz",
    327 => "30ml/1.06oz",
    328 => "30ml/1.2oz",
    329 => "30ml/1oz",
    330 => "30Ml/1Oz",
    331 => "35ml",
    332 => "35ml 35ml",
    333 => "3ml.x5 tubes=15ml./.5oz NIB",
    334 => "4 oz - Pack of 2",
    335 => "4 oz. (Pack of 2)",
    336 => "40g/1.3oz",
    337 => "40ml",
    338 => "40ml 40ml",
    339 => "40ml/1.4oz",
    340 => "44ml",
    341 => "45g Refill Bottle",
    342 => "45ml 45ml",
    343 => "45ml/1.52oz",
    344 => "5.00% 15ml",
    345 => "50 ml by James Read",
    346 => "500ml 500ml",
    347 => "50g 50g",
    348 => "50ml",
    349 => "50ml 50ml",
    350 => "50ml.",
    351 => "50ml/1.69oz",
    352 => "50ml/1.7oz",
    353 => "50Ml/1.7Oz",
    354 => "59.2ml",
    355 => "5ml by Odacite",
    356 => "5pcs 7ml x 5pcs",
    357 => "60 50ml 50ml",
    358 => "60ml",
    359 => "60ml 60ml",
    360 => "60ml/2oz",
    361 => "70ml/2.36oz",
    362 => "75ml/2.53oz",
    363 => "7ml",
    364 => "7x2ml",
    365 => "8.5 oz",
    366 => "80ml 80ml",
    367 => "88ml/3oz",
    368 => "8ml",
    369 => "90ml/3oz",
    370 => "9ml/travel size",
    371 => "Bottle Blue 1 oz (empty bottle for custom-blended serums)",
    372 => "by SkinRenu",
    373 => "fl oz",
    374 => "for Unisex",
    375 => "Net Fl. 1 oz/30 ml",
    376 => "oz",
    377 => "oz/ 30 mL",
    378 => "SPF 25 PA+++ - # Medium 4ml/0.16oz",
    379 => "x 2 fl oz Liquid",
    380 => "L Occitane",
    381 => "KORRES",
    382 => "Amore Pacific"
    ];


//fgetcsv — Gets line from file pointer and parse for CSV fields
while ($row = fgetcsv($fh, 0, ',')){
    //var_dump($row);
    //if the row count is less than 5 ignore it
    if(count($row) < 5) continue;

    //select the first 3 characters (0-3) from the column (space included)
    $first_three = substr($row[1], 0, 3);

    //if the first 3 characters = By or by
    if ($first_three == 'By '|| $first_three == 'by '){

        //then remove it
        $extract_name = substr($row[1], 3);

        $row[1] = $extract_name;
    } else {
        //do nothing and leave it as is
        $extract_name = $row[1];

    }

      foreach($remove as $rItem){
        $row[0]=implode(" ", explode($rItem, $row[0]));
        //$row[0]=implode(" ", explode(" ", $row[0]));
        $row[0]=implode(" ", preg_split('/\s+/', $row[0]));
    }

    // if the first thing in the string = the above extracted sting (the brand)
    if(substr($row[0], 0, strlen($extract_name)) == $extract_name)
    {
        //remove it and replace it with blank
        $remove_brand = str_replace($extract_name, '', $row[0]);
    }
    else
    {
        //do nothing
        $remove_brand = $row[0];
    }

    //new_row equals the above defined row
    $new_row = $row;
    //trim removes white spaces from the beginning of string
    $new_row[0] = trim($remove_brand);



    //create a new file with all the above defined changes
    if (array_search($new_row[0], $all_my_unique_column_values) === false) {
        fputcsv($fh2, $new_row);
        $all_my_unique_column_values[] = $new_row[0];
    }
}

//close the files, (they should close on their own but this is better practice)
fclose($fh);
fclose($fh2);